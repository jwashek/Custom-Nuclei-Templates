id: bugbounty-ssti

info:
  name: SSTI via Params
  author: Justin Washek
  severity: high
  description: |
    Fuzzes query parameters with SSTI payloads and detects evaluated output in rendered HTML (e.g., 592*4 = 2368).
  tags: ssti,headless,fuzzing,templateinjection

headless:
  - steps:
      - action: navigate
        args:
          url: "{{BaseURL}}"

      - action: waitload

      - action: script
        name: ssti_check
        args:
          code: |
            () => {
              const body = document.body.innerText.toLowerCase();
              const hasEval = body.includes('2368');
              const isAccessDenied = body.includes('access denied') || body.includes('403') || body.includes('not authorized') || body.includes('permission denied');
              return (hasEval && !isAccessDenied) ? '2368' : '';
            }

    fuzzing:
      - part: query
        mode: single
        fuzz:
          - "{{592*4}}"
          - "${{592*4}}"
          - "{592*4}"
          - "#{592*4}"
          - "{{592*'4'}}"
          - "${{592*'4'}}"

    matchers:
      - type: word
        part: ssti_check
        words:
          - "2368"

    extractors:
      - type: kval
        part: ssti_check
        kval:
          - ssti_check
